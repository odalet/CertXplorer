using System;
using System.IO;
using System.Linq;
using System.Collections.Generic;
using System.Text;

namespace Delta.CapiNet.Asn1
{
    // This code is probably not mine... Though I can't remember where I grabbed it from.
    internal static class OidUtils
    {
        private static readonly Dictionary<string, string> oidRepository = new()
        {
            { "0.9.2342.19200300.100.1.25", "domainComponent" },
            { "0.4.0.127.0.7.2.2.1.1", "PublicKey-DH" },
            { "0.4.0.127.0.7.2.2.1.2", "PublicKey-ECDH" },
            { "0.4.0.127.0.7.2.2.3.1", "ChipAuthentication-DH" },
            { "0.4.0.127.0.7.2.2.3.1.1", "ChipAuthentication-DH-3DES-CBC-CBC" },
            { "0.4.0.127.0.7.2.2.3.2", "ChipAuthentication-ECDH" },
            { "0.4.0.127.0.7.2.2.3.2.1", "ChipAuthentication-ECDH-3DES-CBC-CBC" },
            { "0.4.0.127.0.7.2.2.2.1", "TerminalAuthentication-RSA" },
            { "0.4.0.127.0.7.2.2.2.1.1", "TerminalAuthentication-RSA-V15-SHA1" },
            { "0.4.0.127.0.7.2.2.2.1.2", "TerminalAuthentication-RSA-V15-SHA256" },
            { "0.4.0.127.0.7.2.2.2.1.3", "TerminalAuthentication-RSA-PSS-SHA1" },
            { "0.4.0.127.0.7.2.2.2.1.4", "TerminalAuthentication-RSA-PSS-SHA256" },
            { "0.4.0.127.0.7.2.2.2.2", "TerminalAuthentication-ECDSA" },
            { "0.4.0.127.0.7.2.2.2.2.1", "TerminalAuthentication-ECDSA-SHA1" },
            { "0.4.0.127.0.7.2.2.2.2.2", "TerminalAuthentication-ECDSA-SHA224" },
            { "0.4.0.127.0.7.2.2.2.2.3", "TerminalAuthentication-ECDSA-SHA256" },
            { "0.4.0.127.0.7.3.1.2.1", "EAC-ePassport" },
            { "1.2.36.68980861.1.1.10", "Signet pilot" },
            { "1.2.36.68980861.1.1.11", "Signet intraNet" },
            { "1.2.36.68980861.1.1.2", "Signet personal" },
            { "1.2.36.68980861.1.1.20", "Signet securityPolicy" },
            { "1.2.36.68980861.1.1.3", "Signet business" },
            { "1.2.36.68980861.1.1.4", "Signet legal" },
            { "1.2.36.75878867.1.100.1.1", "Certificates Australia policyIdentifier" },
            { "1.2.752.34.1", "seis-cp" },
            { "1.2.752.34.1.1", "SEIS certificatePolicy-s10" },
            { "1.2.752.34.2", "SEIS pe" },
            { "1.2.752.34.3", "SEIS at" },
            { "1.2.752.34.3.1", "SEIS at-personalIdentifier" },
            { "1.2.840.10040.2.1", "holdinstruction-none" },
            { "1.2.840.10040.2.2", "holdinstruction-callissuer" },
            { "1.2.840.10040.2.3", "holdinstruction-reject" },
            { "1.2.840.10040.4.1", "dsa" },
            { "1.2.840.10040.4.3", "dsaWithSha1" },
            { "1.2.840.10045.1", "fieldType" },
            { "1.2.840.10045.1.1", "prime-field" },
            { "1.2.840.10045.1.2", "characteristic-two-field" },
            { "1.2.840.10045.1.2.1", "ecPublicKey" },
            { "1.2.840.10045.1.2.3", "characteristic-two-basis" },
            { "1.2.840.10045.1.2.3.1", "onBasis" },
            { "1.2.840.10045.1.2.3.2", "tpBasis" },
            { "1.2.840.10045.1.2.3.3", "ppBasis" },
            { "1.2.840.10045.2", "publicKeyType" },
            { "1.2.840.10045.2.1", "ecPublicKey" },
            { "1.2.840.10046.2.1", "dhPublicNumber" },
            { "1.2.840.113533.7", "nsn" },
            { "1.2.840.113533.7.65", "nsn-ce" },
            { "1.2.840.113533.7.65.0", "entrustVersInfo" },
            { "1.2.840.113533.7.66", "nsn-alg" },
            { "1.2.840.113533.7.66.10", "cast5CBC" },
            { "1.2.840.113533.7.66.11", "cast5MAC" },
            { "1.2.840.113533.7.66.12", "pbeWithMD5AndCAST5-CBC" },
            { "1.2.840.113533.7.66.13", "passwordBasedMac" },
            { "1.2.840.113533.7.66.3", "cast3CBC" },
            { "1.2.840.113533.7.67", "nsn-oc" },
            { "1.2.840.113533.7.67.0", "entrustUser" },
            { "1.2.840.113533.7.68", "nsn-at" },
            { "1.2.840.113533.7.68.0", "entrustCAInfo" },
            { "1.2.840.113533.7.68.10", "attributeCertificate" },
            { "1.2.840.113549.1.1", "pkcs-1" },
            { "1.2.840.113549.1.1.1", "rsaEncryption" },
            { "1.2.840.113549.1.1.2", "md2withRSAEncryption" },
            { "1.2.840.113549.1.1.3", "md4withRSAEncryption" },
            { "1.2.840.113549.1.1.4", "md5withRSAEncryption" },
            { "1.2.840.113549.1.1.5", "sha1withRSAEncryption" },
            { "1.2.840.113549.1.1.11", "sha256withRSAEncryption" },
            { "1.2.840.113549.1.1.12", "sha384withRSAEncryption" },
            { "1.2.840.113549.1.1.13", "sha512withRSAEncryption" },
            { "1.2.840.113549.1.1.14", "sha224withRSAEncryption" },
            { "1.2.840.113549.1.1.6", "rsaOAEPEncryptionSET" },
            { "1.2.840.113549.1.12", "pkcs-12" },
            { "1.2.840.113549.1.12.1", "pkcs-12-PbeIds" },
            { "1.2.840.113549.1.12.1.1", "pbeWithSHAAnd128BitRC4" },
            { "1.2.840.113549.1.12.1.2", "pbeWithSHAAnd40BitRC4" },
            { "1.2.840.113549.1.12.1.3", "pbeWithSHAAnd3-KeyTripleDES-CBC" },
            { "1.2.840.113549.1.12.1.4", "pbeWithSHAAnd2-KeyTripleDES-CBC" },
            { "1.2.840.113549.1.12.1.5", "pbeWithSHAAnd128BitRC2-CBC" },
            { "1.2.840.113549.1.12.1.6", "pbeWithSHAAnd40BitRC2-CBC" },
            { "1.2.840.113549.1.12.10", "pkcs-12Version1" },
            { "1.2.840.113549.1.12.10.1", "pkcs-12BadIds" },
            { "1.2.840.113549.1.12.10.1.1", "pkcs-12-keyBag" },
            { "1.2.840.113549.1.12.10.1.2", "pkcs-12-pkcs-8ShroudedKeyBag" },
            { "1.2.840.113549.1.12.10.1.3", "pkcs-12-certBag" },
            { "1.2.840.113549.1.12.10.1.4", "pkcs-12-crlBag" },
            { "1.2.840.113549.1.12.10.1.5", "pkcs-12-secretBag" },
            { "1.2.840.113549.1.12.10.1.6", "pkcs-12-safeContentsBag" },
            { "1.2.840.113549.1.12.2", "pkcs-12-ESPVKID" },
            { "1.2.840.113549.1.12.2.1", "pkcs-12-PKCS8KeyShrouding" },
            { "1.2.840.113549.1.12.3", "pkcs-12-BagIds" },
            { "1.2.840.113549.1.12.3.1", "pkcs-12-keyBagId" },
            { "1.2.840.113549.1.12.3.2", "pkcs-12-certAndCRLBagId" },
            { "1.2.840.113549.1.12.3.3", "pkcs-12-secretBagId" },
            { "1.2.840.113549.1.12.3.4", "pkcs-12-safeContentsId" },
            { "1.2.840.113549.1.12.3.5", "pkcs-12-pkcs-8ShroudedKeyBagId" },
            { "1.2.840.113549.1.12.4", "pkcs-12-CertBagID" },
            { "1.2.840.113549.1.12.4.1", "pkcs-12-X509CertCRLBagID" },
            { "1.2.840.113549.1.12.4.2", "pkcs-12-SDSICertBagID" },
            { "1.2.840.113549.1.12.5", "pkcs-12-OID" },
            { "1.2.840.113549.1.12.5.1", "pkcs-12-PBEID" },
            { "1.2.840.113549.1.12.5.1.1", "pkcs-12-PBEWithSha1And128BitRC4" },
            { "1.2.840.113549.1.12.5.1.2", "pkcs-12-PBEWithSha1And40BitRC4" },
            { "1.2.840.113549.1.12.5.1.3", "pkcs-12-PBEWithSha1AndTripleDESCBC" },
            { "1.2.840.113549.1.12.5.1.4", "pkcs-12-PBEWithSha1And128BitRC2CBC" },
            { "1.2.840.113549.1.12.5.1.5", "pkcs-12-PBEWithSha1And40BitRC2CBC" },
            { "1.2.840.113549.1.12.5.1.6", "pkcs-12-PBEWithSha1AndRC4" },
            { "1.2.840.113549.1.12.5.1.7", "pkcs-12-PBEWithSha1AndRC2CBC" },
            { "1.2.840.113549.1.12.5.2", "pkcs-12-EnvelopingID" },
            { "1.2.840.113549.1.12.5.2.1", "pkcs-12-RSAEncryptionWith128BitRC4" },
            { "1.2.840.113549.1.12.5.2.2", "pkcs-12-RSAEncryptionWith40BitRC4" },
            { "1.2.840.113549.1.12.5.2.3", "pkcs-12-RSAEncryptionWithTripleDES" },
            { "1.2.840.113549.1.12.5.3", "pkcs-12-SignatureID" },
            { "1.2.840.113549.1.12.5.3.1", "pkcs-12-RSASignatureWithSHA1Digest" },
            { "1.2.840.113549.1.3", "pkcs-3" },
            { "1.2.840.113549.1.3.1", "dhKeyAgreement" },
            { "1.2.840.113549.1.5", "pkcs-5" },
            { "1.2.840.113549.1.5.1", "pbeWithMD2AndDES-CBC" },
            { "1.2.840.113549.1.5.10", "pbeWithSHAAndDES-CBC" },
            { "1.2.840.113549.1.5.3", "pbeWithMD5AndDES-CBC" },
            { "1.2.840.113549.1.5.4", "pbeWithMD2AndRC2-CBC" },
            { "1.2.840.113549.1.5.6", "pbeWithMD5AndRC2-CBC" },
            { "1.2.840.113549.1.5.9", "pbeWithMD5AndXOR" },
            { "1.2.840.113549.1.7", "pkcs-7" },
            { "1.2.840.113549.1.7.1", "data" },
            { "1.2.840.113549.1.7.2", "signedData" },
            { "1.2.840.113549.1.7.3", "envelopedData" },
            { "1.2.840.113549.1.7.4", "signedAndEnvelopedData" },
            { "1.2.840.113549.1.7.5", "digestData" },
            { "1.2.840.113549.1.7.6", "encryptedData" },
            { "1.2.840.113549.1.7.7", "dataWithAttributes" },
            { "1.2.840.113549.1.7.8", "encryptedPrivateKeyInfo" },
            { "1.2.840.113549.1.9", "pkcs-9" },
            { "1.2.840.113549.1.9.1", "emailAddress" },
            { "1.2.840.113549.1.9.10", "issuerAndSerialNumber" },
            { "1.2.840.113549.1.9.11", "passwordCheck" },
            { "1.2.840.113549.1.9.12", "publicKey" },
            { "1.2.840.113549.1.9.13", "signingDescription" },
            { "1.2.840.113549.1.9.14", "extensionReq" },
            { "1.2.840.113549.1.9.15", "sMIMECapabilities" },
            { "1.2.840.113549.1.9.15.1", "preferSignedData" },
            { "1.2.840.113549.1.9.15.2", "canNotDecryptAny" },
            { "1.2.840.113549.1.9.15.3", "receiptRequest" },
            { "1.2.840.113549.1.9.15.4", "receipt" },
            { "1.2.840.113549.1.9.15.5", "contentHints" },
            { "1.2.840.113549.1.9.15.6", "mlExpansionHistory" },
            { "1.2.840.113549.1.9.16", "id-sMIME" },
            { "1.2.840.113549.1.9.16.0", "id-mod" },
            { "1.2.840.113549.1.9.16.0.1", "id-mod-cms" },
            { "1.2.840.113549.1.9.16.0.2", "id-mod-ess" },
            { "1.2.840.113549.1.9.16.1", "id-ct" },
            { "1.2.840.113549.1.9.16.1.1", "id-ct-receipt" },
            { "1.2.840.113549.1.9.16.2", "id-aa" },
            { "1.2.840.113549.1.9.16.2.1", "id-aa-receiptRequest" },
            { "1.2.840.113549.1.9.16.2.2", "id-aa-securityLabel" },
            { "1.2.840.113549.1.9.16.2.3", "id-aa-mlExpandHistory" },
            { "1.2.840.113549.1.9.16.2.4", "id-aa-contentHint" },
            { "1.2.840.113549.1.9.2", "unstructuredName" },
            { "1.2.840.113549.1.9.20", "friendlyName" },
            { "1.2.840.113549.1.9.21", "localKeyID" },
            { "1.2.840.113549.1.9.22", "certTypes" },
            { "1.2.840.113549.1.9.22.1", "x509Certificate" },
            { "1.2.840.113549.1.9.22.2", "sdsiCertificate" },
            { "1.2.840.113549.1.9.23", "crlTypes" },
            { "1.2.840.113549.1.9.23.1", "x509Crl" },
            { "1.2.840.113549.1.9.3", "contentType" },
            { "1.2.840.113549.1.9.4", "messageDigest" },
            { "1.2.840.113549.1.9.5", "signingTime" },
            { "1.2.840.113549.1.9.6", "countersignature" },
            { "1.2.840.113549.1.9.7", "challengePassword" },
            { "1.2.840.113549.1.9.8", "unstructuredAddress" },
            { "1.2.840.113549.1.9.9", "extendedCertificateAttributes" },
            { "1.2.840.113549.2", "digestAlgorithm" },
            { "1.2.840.113549.2.2", "md2" },
            { "1.2.840.113549.2.4", "md4" },
            { "1.2.840.113549.2.5", "md5" },
            { "1.2.840.113549.3", "encryptionAlgorithm" },
            { "1.2.840.113549.3.10", "desCDMF" },
            { "1.2.840.113549.3.2", "rc2CBC" },
            { "1.2.840.113549.3.3", "rc2ECB" },
            { "1.2.840.113549.3.4", "rc4" },
            { "1.2.840.113549.3.5", "rc4WithMAC" },
            { "1.2.840.113549.3.6", "DESX-CBC" },
            { "1.2.840.113549.3.7", "DES-EDE3-CBC" },
            { "1.2.840.113549.3.8", "RC5CBC" },
            { "1.2.840.113549.3.9", "RC5-CBCPad" },
            { "1.2.840.113556.4.3", "microsoftExcel" },
            { "1.2.840.113556.4.4", "titledWithOID" },
            { "1.2.840.113556.4.5", "microsoftPowerPoint" },
            { "1.3.14.2.26.5", "sha" },
            { "1.3.14.3.2.1.1", "rsa" },
            { "1.3.14.3.2.10", "desMAC" },
            { "1.3.14.3.2.11", "rsaSignature" },
            { "1.3.14.3.2.12", "dsa" },
            { "1.3.14.3.2.13", "dsaWithSHA" },
            { "1.3.14.3.2.14", "mdc2WithRSASignature" },
            { "1.3.14.3.2.15", "shaWithRSASignature" },
            { "1.3.14.3.2.16", "dhWithCommonModulus" },
            { "1.3.14.3.2.17", "desEDE" },
            { "1.3.14.3.2.18", "sha" },
            { "1.3.14.3.2.19", "mdc-2" },
            { "1.3.14.3.2.2", "md4WitRSA" },
            { "1.3.14.3.2.2.1", "sqmod-N" },
            { "1.3.14.3.2.20", "dsaCommon" },
            { "1.3.14.3.2.21", "dsaCommonWithSHA" },
            { "1.3.14.3.2.22", "rsaKeyTransport" },
            { "1.3.14.3.2.23", "keyed-hash-seal" },
            { "1.3.14.3.2.24", "md2WithRSASignature" },
            { "1.3.14.3.2.25", "md5WithRSASignature" },
            { "1.3.14.3.2.26", "sha1" },
            { "1.3.14.3.2.27", "dsaWithSHA1" },
            { "1.3.14.3.2.28", "dsaWithCommonSHA1" },
            { "1.3.14.3.2.29", "sha-1WithRSAEncryption" },
            { "1.3.14.3.2.3", "md5WithRSA" },
            { "1.3.14.3.2.3.1", "sqmod-NwithRSA" },
            { "1.3.14.3.2.4", "md4WithRSAEncryption" },
            { "1.3.14.3.2.6", "desECB" },
            { "1.3.14.3.2.7", "desCBC" },
            { "1.3.14.3.2.8", "desOFB" },
            { "1.3.14.3.2.9", "desCFB" },
            { "1.3.14.3.3.1", "simple-strong-auth-mechanism" },
            { "1.3.14.7.2.1.1", "ElGamal" },
            { "1.3.14.7.2.3.1", "md2WithRSA" },
            { "1.3.14.7.2.3.2", "md2WithElGamal" },
            { "1.3.36.3", "algorithm" },
            { "1.3.36.3.1", "encryptionAlgorithm" },
            { "1.3.36.3.1.1", "des" },
            { "1.3.36.3.1.1.1.1", "desECBPad" },
            { "1.3.36.3.1.1.1.1.1", "desECBPadISO" },
            { "1.3.36.3.1.1.2.1", "desCBCPad" },
            { "1.3.36.3.1.1.2.1.1", "desCBCPadISO" },
            { "1.3.36.3.1.2", "idea" },
            { "1.3.36.3.1.2.1", "ideaECB" },
            { "1.3.36.3.1.2.1.1", "ideaECBPad" },
            { "1.3.36.3.1.2.1.1.1", "ideaECBPadISO" },
            { "1.3.36.3.1.2.2", "ideaCBC" },
            { "1.3.36.3.1.2.2.1", "ideaCBCPad" },
            { "1.3.36.3.1.2.2.1.1", "ideaCBCPadISO" },
            { "1.3.36.3.1.2.3", "ideaOFB" },
            { "1.3.36.3.1.2.4", "ideaCFB" },
            { "1.3.36.3.1.3", "des-3" },
            { "1.3.36.3.1.3.1.1", "des-3ECBPad" },
            { "1.3.36.3.1.3.1.1.1", "des-3ECBPadISO" },
            { "1.3.36.3.1.3.2.1", "des-3CBCPad" },
            { "1.3.36.3.1.3.2.1.1", "des-3CBCPadISO" },
            { "1.3.36.3.2", "hashAlgorithm" },
            { "1.3.36.3.2.1", "ripemd160" },
            { "1.3.36.3.2.2", "ripemd128" },
            { "1.3.36.3.2.3", "ripemd256" },
            { "1.3.36.3.2.4", "mdc2singleLength" },
            { "1.3.36.3.2.5", "mdc2doubleLength" },
            { "1.3.36.3.3", "signatureAlgorithm" },
            { "1.3.36.3.3.1", "rsa" },
            { "1.3.36.3.3.1.1", "rsaMitSHA-1" },
            { "1.3.36.3.3.1.2", "rsaMitRIPEMD160" },
            { "1.3.36.3.3.2", "ellipticCurve" },
            { "1.3.36.3.4", "signatureScheme" },
            { "1.3.36.3.4.1", "iso9796-1" },
            { "1.3.36.3.4.2.1", "iso9796-2" },
            { "1.3.36.3.4.2.2", "iso9796-2rsa" },
            { "1.3.36.4", "attribute" },
            { "1.3.36.5", "policy" },
            { "1.3.36.6", "api" },
            { "1.3.36.6.1", "manufacturerSpecific" },
            { "1.3.36.6.2", "functionalitySpecific" },
            { "1.3.36.7", "api" },
            { "1.3.36.7.1", "keyAgreement" },
            { "1.3.36.7.2", "keyTransport" },
            { "1.3.6.1.4.1.2428.10.1.1", "UNINETT policyIdentifier" },
            { "1.3.6.1.4.1.2712.10", "ICE-TEL policyIdentifier" },
            { "1.3.6.1.4.1.3029.32.1", "cryptlibEnvelope" },
            { "1.3.6.1.4.1.3029.32.2", "cryptlibPrivateKey" },
            { "1.3.6.1.4.1.311.10.1", "certTrustList" },
            { "1.3.6.1.4.1.311.10.2", "nextUpdateLocation" },
            { "1.3.6.1.4.1.311.10.3.1", "certTrustListSigning" },
            { "1.3.6.1.4.1.311.10.3.2", "timeStampSigning" },
            { "1.3.6.1.4.1.311.10.3.3", "serverGatedCrypto" },
            { "1.3.6.1.4.1.311.10.3.4", "encryptedFileSystem" },
            { "1.3.6.1.4.1.311.10.4.1", "yesnoTrustAttr" },
            { "1.3.6.1.4.1.311.2.1.10", "spcAgencyInfo" },
            { "1.3.6.1.4.1.311.2.1.11", "spcStatementType" },
            { "1.3.6.1.4.1.311.2.1.12", "spcSpOpusInfo" },
            { "1.3.6.1.4.1.311.2.1.14", "certExtensions" },
            { "1.3.6.1.4.1.311.2.1.15", "spcPelmageData" },
            { "1.3.6.1.4.1.311.2.1.20", "spcLink" },
            { "1.3.6.1.4.1.311.2.1.21", "individualCodeSigning" },
            { "1.3.6.1.4.1.311.2.1.22", "commercialCodeSigning" },
            { "1.3.6.1.4.1.311.2.1.25", "spcLink" },
            { "1.3.6.1.4.1.311.2.1.26", "spcMinimalCriteriaInfo" },
            { "1.3.6.1.4.1.311.2.1.27", "spcFinancialCriteriaInfo" },
            { "1.3.6.1.4.1.311.2.1.28", "spcLink" },
            { "1.3.6.1.4.1.311.2.1.4", "spcIndirectDataContext" },
            { "1.3.6.1.5.5.7", "pkix" },
            { "1.3.6.1.5.5.7.1", "privateExtension" },
            { "1.3.6.1.5.5.7.1.1", "authorityInfoAccess" },
            { "1.3.6.1.5.5.7.2", "policyQualifierIds" },
            { "1.3.6.1.5.5.7.2.1", "cps" },
            { "1.3.6.1.5.5.7.2.2", "unotice" },
            { "1.3.6.1.5.5.7.3", "keyPurpose" },
            { "1.3.6.1.5.5.7.3.1", "serverAuth" },
            { "1.3.6.1.5.5.7.3.2", "clientAuth" },
            { "1.3.6.1.5.5.7.3.3", "codeSigning" },
            { "1.3.6.1.5.5.7.3.4", "emailProtection" },
            { "1.3.6.1.5.5.7.3.5", "ipsecEndSystem" },
            { "1.3.6.1.5.5.7.3.6", "ipsecTunnel" },
            { "1.3.6.1.5.5.7.3.7", "ipsecUser" },
            { "1.3.6.1.5.5.7.3.8", "timeStamping" },
            { "1.3.6.1.5.5.7.4", "cmpInformationTypes" },
            { "1.3.6.1.5.5.7.4.1", "caProtEncCert" },
            { "1.3.6.1.5.5.7.4.2", "signKeyPairTypes" },
            { "1.3.6.1.5.5.7.4.3", "encKeyPairTypes" },
            { "1.3.6.1.5.5.7.4.4", "preferredSymmAlg" },
            { "1.3.6.1.5.5.7.4.5", "caKeyUpdateInfo" },
            { "1.3.6.1.5.5.7.4.6", "currentCRL" },
            { "1.3.6.1.5.5.7.48.1", "ocsp" },
            { "1.3.6.1.5.5.7.48.2", "caIssuers" },
            { "1.3.6.1.5.5.8.1.1", "HMAC-MD5" },
            { "1.3.6.1.5.5.8.1.2", "HMAC-SHA" },
            { "2.16.840.1.101.2.1.1.1", "sdnsSignatureAlgorithm" },
            { "2.16.840.1.101.2.1.1.10", "mosaicKeyManagementAlgorithm" },
            { "2.16.840.1.101.2.1.1.11", "sdnsKMandSigAlgorithm" },
            { "2.16.840.1.101.2.1.1.12", "mosaicKMandSigAlgorithm" },
            { "2.16.840.1.101.2.1.1.13", "SuiteASignatureAlgorithm" },
            { "2.16.840.1.101.2.1.1.14", "SuiteAConfidentialityAlgorithm" },
            { "2.16.840.1.101.2.1.1.15", "SuiteAIntegrityAlgorithm" },
            { "2.16.840.1.101.2.1.1.16", "SuiteATokenProtectionAlgorithm" },
            { "2.16.840.1.101.2.1.1.17", "SuiteAKeyManagementAlgorithm" },
            { "2.16.840.1.101.2.1.1.18", "SuiteAKMandSigAlgorithm" },
            { "2.16.840.1.101.2.1.1.19", "mosaicUpdatedSigAlgorithm" },
            { "2.16.840.1.101.2.1.1.2", "mosaicSignatureAlgorithm" },
            { "2.16.840.1.101.2.1.1.20", "mosaicKMandUpdSigAlgorithms" },
            { "2.16.840.1.101.2.1.1.21", "mosaicUpdatedIntegAlgorithm" },
            { "2.16.840.1.101.2.1.1.22", "mosaicKeyEncryptionAlgorithm" },
            { "2.16.840.1.101.2.1.1.3", "sdnsConfidentialityAlgorithm" },
            { "2.16.840.1.101.2.1.1.4", "mosaicConfidentialityAlgorithm" },
            { "2.16.840.1.101.2.1.1.5", "sdnsIntegrityAlgorithm" },
            { "2.16.840.1.101.2.1.1.6", "mosaicIntegrityAlgorithm" },
            { "2.16.840.1.101.2.1.1.7", "sdnsTokenProtectionAlgorithm" },
            { "2.16.840.1.101.2.1.1.8", "mosaicTokenProtectionAlgorithm" },
            { "2.16.840.1.101.2.1.1.9", "sdnsKeyManagementAlgorithm" },
            { "2.16.840.1.113730.1", "cert-extension" },
            { "2.16.840.1.113730.1.1", "netscape-cert-type" },
            { "2.16.840.1.113730.1.10", "EntityLogo" },
            { "2.16.840.1.113730.1.11", "UserPicture" },
            { "2.16.840.1.113730.1.12", "netscape-ssl-server-name" },
            { "2.16.840.1.113730.1.13", "netscape-comment" },
            { "2.16.840.1.113730.1.2", "netscape-base-url" },
            { "2.16.840.1.113730.1.3", "netscape-revocation-url" },
            { "2.16.840.1.113730.1.4", "netscape-ca-revocation-url" },
            { "2.16.840.1.113730.1.7", "netscape-cert-renewal-url" },
            { "2.16.840.1.113730.1.8", "netscape-ca-policy-url" },
            { "2.16.840.1.113730.1.9", "HomePage-url" },
            { "2.16.840.1.113730.2", "data-type" },
            { "2.16.840.1.113730.2.1", "GIF" },
            { "2.16.840.1.113730.2.2", "JPEG" },
            { "2.16.840.1.113730.2.3", "URL" },
            { "2.16.840.1.113730.2.4", "HTML" },
            { "2.16.840.1.113730.2.5", "netscape-cert-sequence" },
            { "2.16.840.1.113730.2.6", "netscape-cert-url" },
            { "2.16.840.1.113730.3", "directory" },
            { "2.16.840.1.113730.4.1", "serverGatedCrypto" },
            { "2.16.840.1.113733.1.6.3", "Unknown Verisign extension" },
            { "2.16.840.1.113733.1.6.6", "Unknown Verisign extension" },
            { "2.16.840.1.113733.1.7.1.1", "Verisign certificatePolicy" },
            { "2.16.840.1.113733.1.7.1.1.1", "Unknown Verisign policy qualifier" },
            { "2.16.840.1.113733.1.7.1.1.2", "Unknown Verisign policy qualifier" },
            { "2.23.133", "TCPA" },
            { "2.23.133.1", "tcpa_specVersion" },
            { "2.23.133.2", "tcpa_attribute" },
            { "2.23.133.2.1", "tcpa_at_tpmManufacturer" },
            { "2.23.133.2.10", "tcpa_at_securityQualities" },
            { "2.23.133.2.11", "tcpa_at_tpmProtectionProfile" },
            { "2.23.133.2.12", "tcpa_at_tpmSecurityTarget" },
            { "2.23.133.2.13", "tcpa_at_foundationProtectionProfile" },
            { "2.23.133.2.14", "tcpa_at_foundationSecurityTarget" },
            { "2.23.133.2.15", "tcpa_at_tpmIdLabel" },
            { "2.23.133.2.2", "tcpa_at_tpmModel" },
            { "2.23.133.2.3", "tcpa_at_tpmVersion" },
            { "2.23.133.2.4", "tcpa_at_platformManufacturer" },
            { "2.23.133.2.5", "tcpa_at_platformModel" },
            { "2.23.133.2.6", "tcpa_at_platformVersion" },
            { "2.23.133.2.7", "tcpa_at_componentManufacturer" },
            { "2.23.133.2.8", "tcpa_at_componentModel" },
            { "2.23.133.2.9", "tcpa_at_componentVersion" },
            { "2.23.133.3", "tcpa_protocol" },
            { "2.23.133.3.1", "tcpa_prtt_tpmIdProtocol" },
            { "2.23.136.1.1.1", "SOD" },
            { "2.23.42.0", "contentType" },
            { "2.23.42.0.0", "PANData" },
            { "2.23.42.0.1", "PANToken" },
            { "2.23.42.0.2", "PANOnly" },
            { "2.23.42.1", "msgExt" },
            { "2.23.42.10", "national" },
            { "2.23.42.10.192", "Japan" },
            { "2.23.42.2", "field" },
            { "2.23.42.2.0", "fullName" },
            { "2.23.42.2.1", "givenName" },
            { "2.23.42.2.10", "amount" },
            { "2.23.42.2.2", "familyName" },
            { "2.23.42.2.3", "birthFamilyName" },
            { "2.23.42.2.4", "placeName" },
            { "2.23.42.2.5", "identificationNumber" },
            { "2.23.42.2.6", "month" },
            { "2.23.42.2.7", "date" },
            { "2.23.42.2.7.11", "accountNumber" },
            { "2.23.42.2.7.12", "passPhrase" },
            { "2.23.42.2.8", "address" },
            { "2.23.42.2.9", "telephone" },
            { "2.23.42.3", "attribute" },
            { "2.23.42.3.0", "cert" },
            { "2.23.42.3.0.0", "rootKeyThumb" },
            { "2.23.42.3.0.1", "additionalPolicy" },
            { "2.23.42.4", "algorithm" },
            { "2.23.42.5", "policy" },
            { "2.23.42.5.0", "root" },
            { "2.23.42.6", "module" },
            { "2.23.42.7", "certExt" },
            { "2.23.42.7.0", "hashedRootKey" },
            { "2.23.42.7.1", "certificateType" },
            { "2.23.42.7.2", "merchantData" },
            { "2.23.42.7.3", "cardCertRequired" },
            { "2.23.42.7.4", "tunneling" },
            { "2.23.42.7.5", "setExtensions" },
            { "2.23.42.7.6", "setQualifier" },
            { "2.23.42.8", "brand" },
            { "2.23.42.8.1", "IATA-ATA" },
            { "2.23.42.8.30", "Diners" },
            { "2.23.42.8.34", "AmericanExpress" },
            { "2.23.42.8.4", "VISA" },
            { "2.23.42.8.5", "MasterCard" },
            { "2.23.42.8.6011", "Novus" },
            { "2.23.42.9", "vendor" },
            { "2.23.42.9.0", "GlobeSet" },
            { "2.23.42.9.1", "IBM" },
            { "2.23.42.9.10", "Griffin" },
            { "2.23.42.9.11", "Certicom" },
            { "2.23.42.9.12", "OSS" },
            { "2.23.42.9.13", "TenthMountain" },
            { "2.23.42.9.14", "Antares" },
            { "2.23.42.9.15", "ECC" },
            { "2.23.42.9.16", "Maithean" },
            { "2.23.42.9.17", "Netscape" },
            { "2.23.42.9.18", "Verisign" },
            { "2.23.42.9.19", "BlueMoney" },
            { "2.23.42.9.2", "CyberCash" },
            { "2.23.42.9.20", "Lacerte" },
            { "2.23.42.9.21", "Fujitsu" },
            { "2.23.42.9.22", "eLab" },
            { "2.23.42.9.23", "Entrust" },
            { "2.23.42.9.24", "VIAnet" },
            { "2.23.42.9.25", "III" },
            { "2.23.42.9.26", "OpenMarket" },
            { "2.23.42.9.27", "Lexem" },
            { "2.23.42.9.28", "Intertrader" },
            { "2.23.42.9.29", "Persimmon" },
            { "2.23.42.9.3", "Terisa" },
            { "2.23.42.9.30", "NABLE" },
            { "2.23.42.9.31", "espace-net" },
            { "2.23.42.9.32", "Hitachi" },
            { "2.23.42.9.33", "Microsoft" },
            { "2.23.42.9.34", "NEC" },
            { "2.23.42.9.35", "Mitsubishi" },
            { "2.23.42.9.36", "NCR" },
            { "2.23.42.9.37", "e-COMM" },
            { "2.23.42.9.38", "Gemplus" },
            { "2.23.42.9.4", "RSADSI" },
            { "2.23.42.9.5", "VeriFone" },
            { "2.23.42.9.6", "TrinTech" },
            { "2.23.42.9.7", "BankGate" },
            { "2.23.42.9.8", "GTE" },
            { "2.23.42.9.9", "CompuSource" },
            { "2.5.29.1", "authorityKeyIdentifier" },
            { "2.5.29.10", "basicConstraints" },
            { "2.5.29.11", "nameConstraints" },
            { "2.5.29.12", "policyConstraints" },
            { "2.5.29.13", "basicConstraints" },
            { "2.5.29.14", "subjectKeyIdentifier" },
            { "2.5.29.15", "keyUsage" },
            { "2.5.29.16", "privateKeyUsagePeriod" },
            { "2.5.29.17", "subjectAltName" },
            { "2.5.29.18", "issuerAltName" },
            { "2.5.29.19", "basicConstraints" },
            { "2.5.29.2", "keyAttributes" },
            { "2.5.29.20", "cRLNumber" },
            { "2.5.29.21", "cRLReason" },
            { "2.5.29.22", "expirationDate" },
            { "2.5.29.23", "instructionCode" },
            { "2.5.29.24", "invalidityDate" },
            { "2.5.29.25", "cRLDistributionPoints" },
            { "2.5.29.26", "issuingDistributionPoint" },
            { "2.5.29.27", "deltaCRLIndicator" },
            { "2.5.29.28", "issuingDistributionPoint" },
            { "2.5.29.29", "certificateIssuer" },
            { "2.5.29.3", "certificatePolicies" },
            { "2.5.29.30", "nameConstraints" },
            { "2.5.29.31", "cRLDistributionPoints" },
            { "2.5.29.32", "certificatePolicies" },
            { "2.5.29.33", "policyMappings" },
            { "2.5.29.34", "policyConstraints" },
            { "2.5.29.35", "authorityKeyIdentifier" },
            { "2.5.29.36", "policyConstraints" },
            { "2.5.29.37", "extKeyUsage" },
            { "2.5.29.4", "keyUsageRestriction" },
            { "2.5.29.5", "policyMapping" },
            { "2.5.29.6", "subtreesConstraint" },
            { "2.5.29.7", "subjectAltName" },
            { "2.5.29.8", "issuerAltName" },
            { "2.5.29.9", "subjectDirectoryAttributes" },
            { "2.5.4.0", "objectClass" },
            { "2.5.4.1", "aliasObjectName" },
            { "2.5.4.10", "organizationName" },
            { "2.5.4.11", "organizationalUnitName" },
            { "2.5.4.12", "title" },
            { "2.5.4.13", "description" },
            { "2.5.4.14", "searchGuide" },
            { "2.5.4.15", "businessCategory" },
            { "2.5.4.16", "postalAddress" },
            { "2.5.4.17", "postalCode" },
            { "2.5.4.18", "postOfficeBox" },
            { "2.5.4.19", "physicalDeliveryOfficeName" },
            { "2.5.4.2", "knowledgeInformation" },
            { "2.5.4.20", "telephoneNumber" },
            { "2.5.4.21", "telexNumber" },
            { "2.5.4.22", "teletexTerminalIdentifier" },
            { "2.5.4.23", "facsimileTelephoneNumber" },
            { "2.5.4.24", "x121Address" },
            { "2.5.4.25", "internationalISDNNumber" },
            { "2.5.4.26", "registeredAddress" },
            { "2.5.4.27", "destinationIndicator" },
            { "2.5.4.28", "preferredDeliveryMehtod" },
            { "2.5.4.29", "presentationAddress" },
            { "2.5.4.3", "commonName" },
            { "2.5.4.30", "supportedApplicationContext" },
            { "2.5.4.31", "member" },
            { "2.5.4.32", "owner" },
            { "2.5.4.33", "roleOccupant" },
            { "2.5.4.34", "seeAlso" },
            { "2.5.4.35", "userPassword" },
            { "2.5.4.36", "userCertificate" },
            { "2.5.4.37", "caCertificate" },
            { "2.5.4.38", "authorityRevocationList" },
            { "2.5.4.39", "certificateRevocationList" },
            { "2.5.4.4", "surname" },
            { "2.5.4.40", "crossCertificatePair" },
            { "2.5.4.41", "givenName" },
            { "2.5.4.42", "givenName" },
            { "2.5.4.5", "serialNumber" },
            { "2.5.4.52", "supportedAlgorithms" },
            { "2.5.4.53", "deltaRevocationList" },
            { "2.5.4.58", "crossCertificatePair" },
            { "2.5.4.6", "countryName" },
            { "2.5.4.7", "localityName" },
            { "2.5.4.8", "stateOrProvinceName" },
            { "2.5.4.9", "streetAddress" },
            { "2.5.8", "X.500-Algorithms" },
            { "2.5.8.1", "X.500-Alg-Encryption" },
            { "2.5.8.1.1", "rsa" },
            { "1.3.27.1.1", "id-icao-mrtd-security" },
            { "1.3.27.1.1.1", "LDSSecurityObject" },
            { "2.16.840.1.101.3.4.2.1", "sha256" },
            { "2.16.840.1.101.3.4.2.2", "sha384" },
            { "2.16.840.1.101.3.4.2.3", "sha512" }
        };

        public static string GetOidName(string oidKey) => oidRepository.ContainsKey(oidKey) ? oidRepository[oidKey] : string.Empty;

        public static string GetOidKey(string oidName) => oidRepository.Values.SingleOrDefault(v => v == oidName) ?? string.Empty;

        public static string Decode(byte[] data)
        {
            var result = string.Empty;
            using (var ms = new MemoryStream(data))
            {
                result = Decode(ms);
                ms.Close();
            }

            return result;
        }

        public static string Decode(Stream stream)
        {
            var b = (byte)stream.ReadByte();
            var result = new StringBuilder()
                .Append(Convert.ToString(b / 40))
                .Append(".")
                .Append(Convert.ToString(b % 40))
                ;

            while (stream.Position < stream.Length)
            {
                try
                {
                    var v = DecodeValue(stream);
                    _ = result.Append(".").Append(v);
                }
                catch (Exception ex)
                {
                    throw new InvalidDataException($"Failed to decode OID value: {ex.Message}", ex);
                }
            }

            return result.ToString();
        }

        private static ulong DecodeValue(Stream stream)
        {
            byte b;
            var value = 0ul;
            while (true)
            {
                b = (byte)stream.ReadByte();
                value <<= 7;
                value += (ulong)(b & 0x7f);
                if ((b & 0x80) == 0)
                    break;
            }

            return value;
        }
    }
}
